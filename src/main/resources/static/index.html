<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>인증</title>

</head>

<div id="loadBlock">
    <p>Loading ...</p>
</div>
<div style="text-align: center">
    <p>PASSWORD</p>
    <p>
        <input type="password" name="auth" id="loginInput"/>
    </p>
    <button type="button" id="loginBtn" class="btn">로그인</button>
</div>

</body>

<script>

    /** field */
    let lat;
    let lng;

    /** init */
    checkWatchPosition();
    // var checkLoadGeoloactionInterval = setInterval(checkLoadGeolocation, 100);

    /** event */
    document.getElementById('loginBtn').addEventListener('click', getInputValue)

    /** functions */
    function checkWatchPosition() {
        navigator.geolocation.watchPosition(function (position) {
                console.log("enable Geolocation");
                lat=position.coords.latitude;
                lng=position.coords.longitude;
            },
            function (error) {
                if (error.code === error.PERMISSION_DENIED) {
                    console.log(error)

                    console.log("denied Geolocation");
                } else if (error.code === error.POSITION_UNAVAILABLE) {
                    console.log(error)
                    alert("위치 권한이 필요합니다.")
                }


                // window.location.href = "error.html"
            });
    }

    function checkLoadGeolocation() {
        if (lat !== undefined && lng !== undefined) {

            document.getElementById("loadBlock").style.display = "none";

            clearInterval(checkLoadGeoloactionInterval)
        }
    }

    function getInputValue() {

        console.log(document.getElementById("loginInput").value);

        window.location.href = "map.html"
            // + "?lat=" + lat + "&lng=" + lng
        // window.location.href = "map.html" + "?lat=" + lat + "&lng=" + lng
    }

</script>
</html>